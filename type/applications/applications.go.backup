// Package applications provides data structures and initialization for system profiler's SPApplicationsDataType.
package applications

import (
	"sync"
	"fmt"
	"github.com/samburba/go-system-profiler/v2/internal/common"
)

// DataTypeItem represents the structure of SPApplicationsDataType.
type DataTypeItem struct {
	Name         string   `json:"_name"`
	ArchKind     string   `json:"arch_kind,omitempty"`
	LastModified string   `json:"lastModified,omitempty"`
	ObtainedFrom string   `json:"obtained_from,omitempty"`
	Path         string   `json:"path,omitempty"`
	SignedBy     []string `json:"signed_by,omitempty"`
	Version      string   `json:"version,omitempty"`
}

// DataType holds the parsed system profiler data for SPApplicationsDataType.
var DataType *common.DataType[DataTypeItem]

func init() {
	// Ensure correct initialization of DataType.
	data, err := common.NewData[DataTypeItem](common.SPApplicationsDataType)
	if err != nil {
		fmt.Println("Error initializing data:", err)
		return
	}
	DataType = data
}
